<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>유학원 정보 - 유학 정보 플랫폼</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { primary: "#4F46E5", secondary: "#818CF8" },
                    borderRadius: {
                        none: "0px",
                        sm: "4px",
                        DEFAULT: "8px",
                        md: "12px",
                        lg: "16px",
                        xl: "20px",
                        "2xl": "24px",
                        "3xl": "32px",
                        full: "9999px",
                        button: "8px",
                    },
                },
            },
        };
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
            href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
            rel="stylesheet"
    />
    <link
            href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap"
            rel="stylesheet"
    />
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.5.0/echarts.min.js"></script>
    <style>
        :where([class^="ri-"])::before { content: "\f3c2"; }
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .agency-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .custom-checkbox {
            position: relative;
            padding-left: 28px;
            cursor: pointer;
            user-select: none;
        }
        .custom-checkbox input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 20px;
            width: 20px;
            background-color: #fff;
            border: 2px solid #d1d5db;
            border-radius: 4px;
        }
        .custom-checkbox:hover input ~ .checkmark {
            border-color: #4F46E5;
        }
        .custom-checkbox input:checked ~ .checkmark {
            background-color: #4F46E5;
            border-color: #4F46E5;
        }
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }
        .custom-checkbox input:checked ~ .checkmark:after {
            display: block;
        }
        .custom-checkbox .checkmark:after {
            left: 6px;
            top: 2px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
        .custom-radio {
            position: relative;
            padding-left: 28px;
            cursor: pointer;
            user-select: none;
        }
        .custom-radio input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        .radio-mark {
            position: absolute;
            top: 0;
            left: 0;
            height: 20px;
            width: 20px;
            background-color: #fff;
            border: 2px solid #d1d5db;
            border-radius: 50%;
        }
        .custom-radio:hover input ~ .radio-mark {
            border-color: #4F46E5;
        }
        .custom-radio input:checked ~ .radio-mark {
            border-color: #4F46E5;
        }
        .radio-mark:after {
            content: "";
            position: absolute;
            display: none;
        }
        .custom-radio input:checked ~ .radio-mark:after {
            display: block;
        }
        .custom-radio .radio-mark:after {
            top: 3px;
            left: 3px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4F46E5;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 24px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #e5e7eb;
            transition: .4s;
            border-radius: 24px;
        }
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .toggle-slider {
            background-color: #4F46E5;
        }
        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }
        .map-marker {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .map-marker:hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
<!-- 네비게이션 바 -->

<nav th:replace="~{homepage/common/nav-user :: nav-user}"></nav>

<!-- 메인 컨텐츠 -->
<main class="pt-16">
    <!-- 헤더 섹션 -->
    <div class="bg-white shadow-sm">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div
                    class="flex flex-col md:flex-row md:items-center md:justify-between"
            >
                <div>
                    <h1 class="text-3xl font-bold text-gray-900">유학원 찾기</h1>
                    <p class="mt-2 text-lg text-gray-600">
                        전문적인 유학 상담을 제공하는 신뢰할 수 있는 유학원을
                        찾아보세요.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- 필터 섹션 -->
    <div class="bg-white shadow-sm mt-4">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex items-center space-x-4">
                <!-- 검색바 -->
                <div class="relative flex-grow">
                    <div
                            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
                    >
                        <div
                                class="w-5 h-5 text-gray-400 flex items-center justify-center"
                        >
                            <i class="ri-search-line"></i>
                        </div>
                    </div>
                    <input
                            type="text"
                            id="searchKeyword"
                            th:placeholder="${keyword}"
                            class="pl-10 pr-4 py-2 w-full border border-gray-300 !rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary text-sm"
                    />
                </div>
                <!-- 지역 필터 -->
                <div class="relative inline-block text-left" id="region-filter">
                    <button
                            type="button"
                            class="inline-flex justify-between items-center w-full px-4 py-2 border border-gray-300 !rounded-button bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
                            id="region-menu-button"
                    >
                        <span>지역</span>
                        <div class="w-5 h-5 ml-2 flex items-center justify-center">
                            <i class="ri-arrow-down-s-line"></i>
                        </div>
                    </button>
                    <div
                            class="hidden origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10"
                            id="region-menu"
                    >
                        <div class="class= py-1 max-h-60 overflow-y-auto region-menu-list" role="none">
                            <button type="button" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">전체</button>
                        </div>
                    </div>
                </div>
                <div>
<!--                    검색 버튼-->
                    <button type="submit" class="bg-primary text-white px-4 py-2 rounded-button whitespace-nowrap flex items-center" id="searchButton">
                        검색
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- 목록 보기 섹션 -->
    <div id="list-view" class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="mb-6 flex justify-between items-center">
            <h2 class="text-xl font-semibold text-gray-900">
                    총 <span class="text-primary" th:text="${agencyDto.totalElements}">0</span>개의 유학원
            </h2>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            <div
                    th:each="agency : ${agencyDto}"
                    class="agency-card bg-white rounded-lg shadow-md overflow-hidden transition-all duration-300"
            >
                <div class="h-48 overflow-hidden">
                    <img
                            th:src="${agency.imgUrl}"
                            th:alt="${agency.agencyName}"
                            class="w-full h-full object-cover object-top"
                    />
                </div>
                <div class="p-6">
                    <h3 class="text-lg font-semibold text-gray-900" th:text="${agency.agencyName}">유학원 이름</h3>
                    <p class="mt-2 text-sm text-gray-600" th:text="${agency.agencyAddress1} + ' ' + ${agency.agencyAddress2}">주소</p>
                    <p class="mt-2 text-sm text-gray-600" th:text="${agency.agencyPhone}">전화번호</p>
                    <p class="mt-2 text-sm text-gray-600" th:text="'대표자: ' + ${agency.agencyOwner}">대표자</p>
                </div>
            </div>
        </div>
        <div  class="mt-8 flex justify-center items-center space-x-2" th:if="${agencyDto.totalPages > 0}">
<!--            여기에 페이지 이동하는거 필요함.-->
            <!-- 이전 버튼 -->
            <a th:if="${agencyDto.hasPrevious()}"
               th:href="@{/agency/list(page=${agencyDto.number - 1})}"
               class="px-3 py-1 rounded border text-sm text-gray-700 hover:bg-gray-100">이전</a>

            <!-- 페이지 번호 -->
            <span th:each="pageNum : ${#numbers.sequence(0, agencyDto.totalPages - 1)}">
                <a th:href="@{/agency/list(page=${pageNum}, keyword=${keyword}, region=${region})}"
                   th:text="${pageNum + 1}"
                   th:class="${pageNum == agencyDto.number} ?
                             'px-3 py-1 rounded bg-primary text-white text-sm' :
                             'px-3 py-1 rounded border text-sm text-gray-700 hover:bg-gray-100'">
                </a>
            </span>
            <!-- 다음 버튼 -->
            <a th:if="${agencyDto.hasNext()}"
               th:href="@{/agency/list(page=${agencyDto.number + 1})}"
               class="px-3 py-1 rounded border text-sm text-gray-700 hover:bg-gray-100">다음</a>
        </div>

    </div>
</main>
<!-- 푸터 -->
<footer class="bg-gray-900 text-white">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
            <div>
                <a href="#" class="text-2xl font-['Pacifico'] text-white">logo</a>
                <p class="mt-4 text-gray-400">
                    당신의 꿈을 위한 완벽한 유학 가이드. 전 세계 유수의 대학교와
                    신뢰할 수 있는 유학원 정보를 한 곳에서 만나보세요.
                </p>
            </div>
            <div>
                <h3 class="text-lg font-semibold mb-4">서비스</h3>
                <ul class="space-y-2">
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white">유학 정보</a>
                    </li>
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white"
                        >대학교 찾기</a
                        >
                    </li>
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white"
                        >유학원 찾기</a
                        >
                    </li>
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white"
                        >장학금 정보</a
                        >
                    </li>
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white">비자 안내</a>
                    </li>
                </ul>
            </div>
            <div>
                <h3 class="text-lg font-semibold mb-4">회사 정보</h3>
                <ul class="space-y-2">
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white">회사 소개</a>
                    </li>
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white">이용약관</a>
                    </li>
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white"
                        >개인정보처리방침</a
                        >
                    </li>
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white"
                        >자주 묻는 질문</a
                        >
                    </li>
                    <li>
                        <a href="#" class="text-gray-400 hover:text-white">고객센터</a>
                    </li>
                </ul>
            </div>
            <div>
                <h3 class="text-lg font-semibold mb-4">연락처</h3>
                <ul class="space-y-2">
                    <li class="flex items-center">
                        <div class="w-5 h-5 flex items-center justify-center mr-2">
                            <i class="ri-map-pin-line"></i>
                        </div>
                        <span class="text-gray-400"
                        >서울특별시 강남구 테헤란로 123</span
                        >
                    </li>
                    <li class="flex items-center">
                        <div class="w-5 h-5 flex items-center justify-center mr-2">
                            <i class="ri-phone-line"></i>
                        </div>
                        <span class="text-gray-400">02-123-4567</span>
                    </li>
                    <li class="flex items-center">
                        <div class="w-5 h-5 flex items-center justify-center mr-2">
                            <i class="ri-mail-line"></i>
                        </div>
                        <span class="text-gray-400">info@studyabroad.kr</span>
                    </li>
                </ul>
                <div class="mt-6 flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white">
                        <div
                                class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-800"
                        >
                            <i class="ri-instagram-line"></i>
                        </div>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white">
                        <div
                                class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-800"
                        >
                            <i class="ri-facebook-fill"></i>
                        </div>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white">
                        <div
                                class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-800"
                        >
                            <i class="ri-youtube-fill"></i>
                        </div>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white">
                        <div
                                class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-800"
                        >
                            <i class="ri-kakao-talk-fill"></i>
                        </div>
                    </a>
                </div>
            </div>
        </div>
        <div
                class="mt-12 pt-8 border-t border-gray-800 text-center text-gray-400 text-sm"
        >
            <p>© 2025 유학 정보 플랫폼. All rights reserved.</p>
        </div>
    </div>
</footer>
<script type="module" id="api-bootstrap">
    import { api } from "/js/homepage/lib/apiClient.js";
    window.api = api;
    window.dispatchEvent(new Event("api-ready"));
</script>

        <script id="region-dropdown-loader">
            (function () {
                let selectedRegion = "";

                async function initRegionFilter() {
                    const menu = document.getElementById("region-menu");
                    const menuButton = document.getElementById("region-menu-button");
                    const list = document.querySelector("#region-menu .region-menu-list");
                    const searchButton = document.getElementById("searchButton");
                    const keywordInput = document.getElementById("searchKeyword");

                    if (!menu || !menuButton || !list) {
                        console.warn("region filter 요소를 찾을 수 없습니다.");
                        return;
                    }

                    // 1) 드롭다운 열기/닫기 토글
                    menuButton.addEventListener("click", () => {
                        menu.classList.toggle("hidden");
                    });

                    // 2) ESC / 바깥 클릭 시 닫기 (선택)
                    document.addEventListener("click", (e) => {
                        if (!menu.contains(e.target) && !menuButton.contains(e.target)) {
                            menu.classList.add("hidden");
                        }
                    });

                    // 3) 지역 목록 API 호출
                    try {
                        const res = await window.api.get("/api/v1/agency/region");
                        console.log("region api result:", res);

                        const regions =
                            Array.isArray(res) ? res
                                : Array.isArray(res.data) ? res.data
                                    : Array.isArray(res.result) ? res.result
                                        : [];

                        list.innerHTML = ""; // 초기화
                        const btn = document.createElement("button");
                        btn.type = "button";
                        btn.className = "block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100";
                        btn.textContent = "전체";
                        list.appendChild(btn);
                        regions.forEach(region => {
                            const btn = document.createElement("button");
                            btn.type = "button";
                            btn.className = "block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100";
                            btn.textContent = region;
                            list.appendChild(btn);
                        });

                    } catch (e) {
                        console.error("지역 목록 불러오기 실패:", e);
                        return;
                    }



                    // 5) 버튼 클릭 시 선택값 반영 (이벤트 위임)
                    list.addEventListener("click", (e) => {
                        const target = e.target;
                        if (!target.matches("button")) return;

                        selectedRegion = target.textContent.trim();
                        const labelSpan = menuButton.querySelector("span");
                        if (labelSpan) {
                            labelSpan.textContent = selectedRegion;
                        }
                        menu.classList.add("hidden");
                    });

                    if (searchButton) {
                        searchButton.addEventListener("click", (e) => {
                            e.preventDefault();

                            const keyword = keywordInput?.value.trim() || "";
                            const params = new URLSearchParams();

                            if (keyword) params.append("keyword", keyword);
                            if (selectedRegion) params.append("region", selectedRegion);

                            window.location.href = `/agency/list?${params.toString()}`;
                        });
                    }

                }

                document.addEventListener("DOMContentLoaded", () => {
                    initRegionFilter();
                });
            })();
        </script>

</body>
</html>
