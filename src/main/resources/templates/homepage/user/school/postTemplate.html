<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout/university-layout :: university-layout(~{::head}, ~{::main}, ~{::script})}">
<head>
    <title>공지사항 - 국제 프로그램</title>
</head>
<main class="min-w-0 flex-1 py-6 px-0 md:px-6">
    <div class="bg-white rounded shadow p-6">
        <div class="flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4">
            <h2 class="text-2xl font-bold text-gray-800">공지사항</h2>
            <div class="flex items-center gap-3">
                <div class="relative">
                    <input type="search" placeholder="공지사항 검색"
                           class="pl-10 pr-4 py-2 w-full md:w-64 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"/>
                    <div class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 flex items-center justify-center text-gray-400">
                        <i class="ri-search-line"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="overflow-x-auto">
            <table class="min-w-full">
                <thead>
                <tr class="bg-gray-50 text-left">
                    <th class="px-4 py-3 text-sm font-medium text-gray-600 border-b w-16">
                        번호
                    </th>
                    <th class="px-4 py-3 text-sm font-medium text-gray-600 border-b">
                        제목
                    </th>
                    <th class="px-4 py-3 text-sm font-medium text-gray-600 border-b w-24">
                        작성자
                    </th>
                    <th class="px-4 py-3 text-sm font-medium text-gray-600 border-b w-28">
                        작성일
                    </th>
                    <th class="px-4 py-3 text-sm font-medium text-gray-600 border-b w-20">
                        조회수
                    </th>
                </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                <th:block th:each="post, iterStat : ${postDto}">
                    <tr class="post-row cursor-pointer" th:classappend="${post.type == 'NOTICE'} ? ' important' : ''"
                        th:attr="data-school=${school}, data-post-id=${post.id}, data-board-id=${boardId}">

                        <!-- 첫 번째 칸: 공지 여부에 따라 내용 다르게 -->
                        <td class="px-4 py-4 text-sm text-gray-600 text-center">
                            <div th:if="${post.type == 'NOTICE'}" class="flex items-center gap-2 justify-center">
                                <div class="w-5 h-5 flex items-center justify-center text-red-500">
                                    <i class="ri-pushpin-fill"></i>
                                </div>
                                <span class="font-medium">공지</span>
                            </div>
                            <span th:if="${post.type != 'NOTICE'}"
                                  th:text="${postDto.totalElements - (postDto.number * postDto.size) - iterStat.index}"></span>
                        </td>

                        <!-- 제목, 설명, 첨부파일 -->
                        <td class="px-4 py-4">
                            <div class="flex items-center gap-3">
                                <div>
                                    <p class="font-medium text-gray-800 hover:text-primary" th:text="${post.title}"></p>
                                    <p class="text-xs text-gray-500 mt-0.5" th:text="${post.description}"></p>
                                </div>
                                <div class="w-5 h-5 flex items-center justify-center text-gray-400"
                                     th:if="${post.isFile}">
                                    <i class="ri-attachment-line"></i>
                                </div>
                            </div>
                        </td>

                        <!-- 작성자, 작성일, 조회수 -->
                        <td class="px-4 py-4 text-sm text-gray-600">작성자</td>
                        <td class="px-4 py-4 text-sm text-gray-600"
                            th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd')}"></td>
                        <td class="px-4 py-4 text-sm text-gray-600"
                            th:text="${#numbers.formatInteger(post.views, 1, 'COMMA')}"></td>
                    </tr>
                </th:block>

                </tbody>
            </table>
        </div>
        <div class="flex items-center justify-between mt-6">
            <!-- 1. 총 게시글 개수 및 현재 범위 -->
            <p class="text-sm text-gray-600">
                총 <span th:text="${postDto.totalElements}"></span>개 게시글 중
                <span th:text="${postDto.number * postDto.size + 1}"></span> -
                <span th:text="${postDto.number * postDto.size + postDto.numberOfElements}"></span>
            </p>

            <!-- 2. 페이지 버튼 -->
            <div class="flex items-center gap-1">
                <!-- 이전 버튼 -->
                <a th:href="@{'/school/' + ${school} + '/board/' + ${boardId} + '?page=' + ${postDto.number - 1}}"
                   class="w-9 h-9 flex items-center justify-center rounded border border-gray-300 text-gray-500 hover:bg-gray-50 whitespace-nowrap !rounded-button"
                   th:classappend="${postDto.first} ? ' opacity-50 cursor-not-allowed pointer-events-none' : ''">
                    <div class="w-5 h-5 flex items-center justify-center">
                        <i class="ri-arrow-left-s-line"></i>
                    </div>
                </a>

                <!-- 페이지 번호들 -->
                <th:block th:each="i : ${#numbers.sequence(0, postDto.totalPages - 1)}">
                    <a th:href="@{'/school/' + ${school} + '/board/' + ${boardId} + '?page=' + ${i}}"
                       class="w-9 h-9 flex items-center justify-center rounded border whitespace-nowrap !rounded-button"
                       th:classappend="${i == postDto.number} ? ' bg-primary text-white hover:bg-primary/90' : ' border-gray-300 text-gray-700 hover:bg-gray-50'">
                        <span th:text="${i + 1}"></span>
                    </a>
                </th:block>

                <!-- 다음 버튼 -->
                <a th:href="@{'/school/' + ${school} + '/board/' + ${boardId} + '?page=' + ${postDto.number + 1}}"
                   class="w-9 h-9 flex items-center justify-center rounded border border-gray-300 text-gray-500 hover:bg-gray-50 whitespace-nowrap !rounded-button"
                   th:classappend="${postDto.last} ? ' opacity-50 cursor-not-allowed pointer-events-none' : ''">
                    <div class="w-5 h-5 flex items-center justify-center">
                        <i class="ri-arrow-right-s-line"></i>
                    </div>
                </a>

            </div>
        </div>
    </div>
    <div class="mt-8 bg-white rounded shadow p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">
            공지사항 이용 안내 </h3>
        <div class="space-y-4">
            <div class="flex items-start gap-3">
                <div class="w-6 h-6 flex items-center justify-center text-primary mt-0.5">
                    <i class="ri-information-line"></i>
                </div>
                <div>
                    <p class="text-gray-700">
                        중요한 공지사항은 상단에 고정되어 표시됩니다. </p>
                </div>
            </div>
            <div class="flex items-start gap-3">
                <div class="w-6 h-6 flex items-center justify-center text-primary mt-0.5">
                    <i class="ri-attachment-line"></i>
                </div>
                <div>
                    <p class="text-gray-700">
                        첨부파일이 있는 게시글은
                        <span class="font-medium">클립 아이콘</span>으로 표시됩니다. </p>
                </div>
            </div>
            <div class="flex items-start gap-3">
                <div class="w-6 h-6 flex items-center justify-center text-primary mt-0.5">
                    <i class="ri-search-line"></i>
                </div>
                <div>
                    <p class="text-gray-700">
                        검색창을 통해 제목과 내용으로 게시글을 찾을 수 있습니다. </p>
                </div>
            </div>
            <div class="flex items-start gap-3">
                <div class="w-6 h-6 flex items-center justify-center text-primary mt-0.5">
                    <i class="ri-question-line"></i>
                </div>
                <div>
                    <p class="text-gray-700">
                        문의사항은 국제교류처 (02-1234-5678)로 연락주세요. </p>
                </div>
            </div>
        </div>
    </div>
</main>
<!--<script id="filterDropdownScript" type="module">-->
<!--    document.addEventListener("DOMContentLoaded", function () {-->
<!--        const filterButton = document.getElementById("filterButton");-->
<!--        const filterDropdown = document.getElementById("filterDropdown");-->
<!--        filterButton.addEventListener("click", function () {-->
<!--            filterDropdown.classList.toggle("hidden");-->
<!--        });-->
<!--        document.addEventListener("click", function (event) {-->
<!--            if (-->
<!--                !filterButton.contains(event.target) &&-->
<!--                !filterDropdown.contains(event.target)-->
<!--            ) {-->
<!--                filterDropdown.classList.add("hidden");-->
<!--            }-->
<!--        });-->
<!--    });-->
<!--</script>-->
<script id="postClickScript" type="module">
    const postRows = document.querySelectorAll(".post-row");
    postRows.forEach((row) => {
        row?.addEventListener("click", function () {
            const school = this.dataset.school;
            const boardId = this.dataset.boardId;
            const postId = this.dataset.postId;
            window.location.href = `/school/${school}/board/${boardId}/post/${postId}`;
        });
    });
</script>
<script id="searchScript" type="module">
    const searchInput = document.querySelector('input[type="search"]');
    searchInput?.addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
            const searchTerm = this.value.trim();
            if (searchTerm) {
                console.log("검색어:", searchTerm);
            }
        }
    });
</script>
</html>