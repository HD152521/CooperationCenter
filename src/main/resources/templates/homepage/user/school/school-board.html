<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout/university-layout :: university-layout(~{::head}, ~{::main}, ~{::script})}">
<head>
    <title>国际项目 - 申请表格</title>
</head>

<main class="min-w-0 flex-1 py-6 px-0 md:px-6">
    <div class="bg-white rounded shadow p-6">
        <div class="flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4">
            <h2 class="text-2xl font-bold text-gray-800">学校申请表格</h2>
            <div class="flex items-center gap-3">
                <div class="relative">
                    <input type="search" placeholder="搜索表格"
                           class="pl-10 pr-4 py-2 w-full md:w-64 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    <div class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 flex items-center justify-center text-gray-400">
                        <i class="ri-search-line"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- 중요 공지 -->
        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded">
            <div class="flex items-start gap-3">
                <div class="w-6 h-6 flex items-center justify-center text-yellow-500 mt-0.5">
                    <i class="ri-information-line"></i>
                </div>
                <div>
                    <h3 class="font-medium text-gray-800">2025-2026学年申请截止日期</h3>
                    <p class="text-gray-700 text-sm mt-1">
                        请在2025年7月31日前提交所有申请表。截止日期后无法受理。
                    </p>
                </div>
            </div>
        </div>

        <div class="overflow-x-auto">
            <table class="min-w-full">
                <thead>
                <tr class="bg-gray-50 text-left">
                    <th class="px-4 py-3 text-sm font-medium text-gray-600 border-b">文件名</th>
                    <th class="px-4 py-3 text-sm font-medium text-gray-600 border-b">更新日期</th>
                    <th class="px-4 py-3 text-sm font-medium text-gray-600 border-b">下载</th>
                </tr>
                </thead>

                <tbody class="divide-y divide-gray-200" th:if="${filePostDto != null}">
                <th:block th:each="post, iterStat : ${filePostDto}">
                    <tr class="post-row cursor-pointer"
                        th:classappend="${post.type == 'NOTICE'} ? ' bg-amber-50' : ''"
                        th:attr="data-school=${school}, data-post-id=${post.id}, data-board-id=${boardId}">

                        <!-- 1) 제목/설명 + 공지/일반 아이콘/배지 -->
                        <td class="px-4 py-4">
                            <div class="flex items-center gap-3">
                                <!-- 아이콘: 공지/일반 분기 -->
                                <div th:if="${post.type == 'NOTICE'}"
                                     class="w-8 h-8 flex items-center justify-center rounded bg-amber-100 text-amber-700">
                                    <i class="ri-pushpin-2-fill"></i>
                                </div>
                                <div th:if="${post.type != 'NOTICE'}"
                                     class="w-8 h-8 flex items-center justify-center rounded bg-gray-100 text-gray-600">
                                    <i class="ri-file-text-line"></i>
                                </div>

                                <div>
                                    <div class="flex items-center gap-2">
                                        <!-- 공지 배지 -->
                                        <span th:if="${post.type == 'NOTICE'}"
                                              class="inline-flex items-center px-2 py-0.5 text-[11px] rounded bg-amber-200 text-amber-800">
                                            公告
                                        </span>
                                        <p class="font-medium text-gray-900 hover:text-primary"
                                           th:text="${post.title}">
                                            文件标题
                                        </p>
                                    </div>
                                    <p class="text-xs text-gray-600 mt-0.5"
                                       th:text="${post.description} ?: '暂无说明'">
                                        说明
                                    </p>
                                </div>

                                <div class="w-5 h-5 flex items-center justify-center text-gray-400"
                                     th:if="${post.isFile}">
                                    <i class="ri-attachment-line"></i>
                                </div>
                            </div>
                        </td>

                        <!-- 2) 작성일 -->
                        <td class="px-4 py-4 text-sm text-gray-700"
                            th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd')}">
                            2025-06-01
                        </td>

                        <!-- 3) 다운로드 버튼 -->
                        <td class="px-4 py-4">
                            <a class="inline-flex items-center gap-1 px-2.5 py-1 text-xs bg-primary text-white rounded-md
                  hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary/40"
                               th:href="@{/api/v1/file/school/{fileId}(fileId=${post.fileId})}">
                                <div class="w-4 h-4 flex items-center justify-center">
                                    <i class="ri-download-line"></i>
                                </div>
                                <span>下载</span>
                            </a>
                        </td>
                    </tr>
                </th:block>

                <!-- 비어있을 때 -->
                <tr th:if="${#lists.isEmpty(filePostDto.content)}">
                    <td class="px-4 py-6 text-center text-sm text-gray-500" colspan="3">
                        暂无已登记的文件。
                    </td>
