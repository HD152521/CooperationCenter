<nav th:fragment="nav-user" xmlns:th="http://www.thymeleaf.org"
     class="bg-white shadow-sm w-full sticky top-0 z-10">
    <div th:replace="~{fragments/layout/responsive-layout :: responsive(~{::nav-contents})}">
        <div th:fragment="nav-contents" class="flex items-center justify-between h-16">

            <!-- 왼쪽 로고 -->
            <div class="flex items-center">
                <a href="/home" class="flex-shrink-0 flex items-center">
                    <span class="text-2xl font-['Pacifico'] text-primary">logo</span>
                </a>

                <!-- 데스크탑 메뉴 -->
                <div class="hidden sm:ml-10 sm:flex sm:space-x-8"
                     th:if="${!requestURI.startsWith('/profile')}">
                    <a href="/home"
                       th:classappend="${requestURI == '/home' ? 'border-primary text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}"
                       class="inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                        홈
                    </a>

                    <!-- 대학교 드롭다운 (group-hover 및 group-focus-within 사용) -->
                    <div class="relative group">
                        <button th:classappend="${requestURI.startsWith('/school') ? 'border-primary text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}"
                                class="inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium h-full">
                            대학교
                            <i class="ri-arrow-down-s-line ml-1 transition-transform duration-200 group-hover:rotate-180 group-focus-within:rotate-180"></i>
                        </button>
                        <div class="absolute top-full left-1/2 -translate-x-1/2 mt-1 bg-white rounded-lg shadow-lg py-2 w-48
                                    invisible opacity-0 group-hover:visible group-hover:opacity-100
                                    group-focus-within:visible group-focus-within:opacity-100
                                    transition-all duration-200">
                            <a th:each="school : ${schoolCategory}"
                               th:href="@{'/school/' + ${school.englishName} + '/board/' + ${school.firstBoardId}}"
                               th:text="${school.koreanName}"
                               class="block px-4 py-2 text-gray-700 hover:bg-gray-50 hover:text-primary">
                            </a>
                        </div>
                    </div>

                    <a href="/agency/list"
                       th:classappend="${requestURI.startsWith('/agency') ? 'border-primary text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}"
                       class="inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                        유학원
                    </a>

                    <a th:if="${loginMember != null}" href="/survey/list"
                       th:classappend="${requestURI.startsWith('/survey') ? 'border-primary text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}"
                       class="inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                        설문조사
                    </a>
                </div>
            </div>

            <!-- 오른쪽 로그인/프로필 -->
            <div class="relative group">
                <a href="/member/login" th:if="${loginMember == null}"
                   class="px-4 py-2 rounded-md whitespace-nowrap cursor-pointer bg-primary text-white transition-all duration-300 hover:bg-indigo-800">
                    로그인
                </a>

                <button th:unless="${loginMember == null}"
                        class="size-[42px] flex items-center justify-center text-sm font-bold text-indigo-600 bg-indigo-200 rounded-full"
                   th:text="${loginMember.memberName.substring(0, 1)}">
                </button>
                <div th:unless="${loginMember == null}"
                     class="absolute top-full right-0 mt-1 bg-white rounded-lg shadow-lg py-2 w-48
                            invisible opacity-0 group-hover:visible group-hover:opacity-100
                            group-focus-within:visible group-focus-within:opacity-100
                            transition-all duration-200">
                    <button id="web-logout-button"
                            class="px-4 py-2 w-full text-gray text-left -700 hover:bg-gray-50 hover:text-primary">
                        로그아웃
                    </button>
                </div>
            </div>

            <!-- 모바일 햄버거 버튼 -->
            <div class="flex items-center sm:hidden"
                 th:if="${!requestURI.startsWith('/profile')}">
                <button id="mobile-menu-button"
                        type="button"
                        class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary">
                    <span class="sr-only">메뉴 열기</span>
                    <i class="ri-menu-line ri-lg"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- 모바일 메뉴 -->
    <div id="mobile-menu"
         class="hidden absolute top-16 left-0 w-full bg-white shadow-lg border-t border-gray-100 z-[9998]"
         th:if="${!requestURI.startsWith('/profile')}">

        <div class="pt-2 pb-3 space-y-1">
            <a href="/home" class="block pl-4 pr-4 py-2 text-gray-700 hover:bg-gray-100">홈</a>

            <button id="mobile-university-button"
                    class="w-full flex justify-between items-center pl-4 pr-4 py-2 text-gray-700 hover:bg-gray-100">
                대학교
                <i class="ri-arrow-down-s-line transition-transform"></i>
            </button>

            <div id="mobile-university-menu" class="ml-6 mt-1 space-y-1 hidden">
                <a th:each="school : ${schoolCategory}"
                   th:href="@{'/school/' + ${school.englishName} + '/board/' + ${school.firstBoardId}}"
                   th:text="${school.koreanName}"
                   class="block text-gray-600 hover:text-primary"></a>
            </div>

            <a href="/agency/list" class="block pl-4 pr-4 py-2 text-gray-700 hover:bg-gray-100">유학원</a>
            <a th:if="${loginMember != null}" href="/survey/list"
               class="block pl-4 pr-4 py-2 text-gray-700 hover:bg-gray-100">설문조사</a>
        </div>
    </div>
</nav>