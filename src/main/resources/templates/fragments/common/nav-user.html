<nav th:fragment="nav-user" xmlns:th="http://www.thymeleaf.org"
     class="bg-white shadow-sm w-full sticky top-0 z-10">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">

            <!-- 왼쪽 로고 -->
            <div class="flex items-center">
                <a href="/home" class="flex-shrink-0 flex items-center">
                    <span class="text-2xl font-['Pacifico'] text-primary">logo</span>
                </a>

                <!-- 데스크탑 메뉴 -->
                <div class="hidden sm:ml-10 sm:flex sm:space-x-8"
                     th:if="${!requestURI.startsWith('/profile')}">
                    <a href="/home"
                       th:classappend="${requestURI == '/home' ? 'border-primary text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}"
                       class="inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                        홈
                    </a>

                    <!-- 대학교 드롭다운 -->
                    <div id="university-dropdown" class="relative">
                        <button id="university-button"
                                th:classappend="${requestURI.startsWith('/school') ? 'border-primary text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}"
                                class="inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                            대학교
                            <i class="ri-arrow-down-s-line ml-1"></i>
                        </button>
                        <div id="university-menu"
                             class="absolute top-full left-0 mt-1 bg-white rounded-lg shadow-lg py-2 w-48 hidden transition duration-200">
                            <a th:each="school : ${schoolCategory}"
                               th:href="@{'/school/' + ${school.englishName} + '/board/' + ${school.firstBoardId}}"
                               th:text="${school.koreanName}"
                               class="block px-4 py-2 text-gray-700 hover:bg-gray-50 hover:text-primary">
                            </a>
                        </div>
                    </div>

                    <a href="/agency/list"
                       th:classappend="${requestURI.startsWith('/agency') ? 'border-primary text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}"
                       class="inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                        유학원
                    </a>

                    <a th:if="${loginMember != null}" href="/survey/list"
                       th:classappend="${requestURI.startsWith('/survey') ? 'border-primary text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}"
                       class="inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                        설문조사
                    </a>
                </div>
            </div>

            <!-- 오른쪽 로그인/프로필 -->
            <div>
                <a
                        id="web-login-button"
                        href="/member/login"
                        th:class="${requestURI.startsWith('/profile') || loginMember == null} ?
                          'bg-indigo-600 text-white px-4 py-2 !rounded-button whitespace-nowrap' :
                          'text-sm font-medium w-full h-full flex items-center justify-center'"
                        th:text="${loginMember == null ?
                          '로그인' :
                          (#strings.startsWith(requestURI, '/profile') ? '로그아웃' : loginMember.memberName.substring(0, 1))}">
                </a>
            </div>

            <!-- 모바일 햄버거 버튼 -->
            <div class="flex items-center sm:hidden"
                 th:if="${!requestURI.startsWith('/profile')}">
                <button id="mobile-menu-button"
                        type="button"
                        class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary">
                    <span class="sr-only">메뉴 열기</span>
                    <i class="ri-menu-line ri-lg"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- 모바일 메뉴 -->
    <div id="mobile-menu"
         class="hidden absolute top-16 left-0 w-full bg-white shadow-lg border-t border-gray-100 z-[9998]"
         th:if="${!requestURI.startsWith('/profile')}">

        <div class="pt-2 pb-3 space-y-1">
            <a href="/home" class="block pl-4 pr-4 py-2 text-gray-700 hover:bg-gray-100">홈</a>

            <button id="mobile-university-button"
                    class="w-full flex justify-between items-center pl-4 pr-4 py-2 text-gray-700 hover:bg-gray-100">
                대학교
                <i class="ri-arrow-down-s-line transition-transform"></i>
            </button>

            <div id="mobile-university-menu" class="ml-6 mt-1 space-y-1 hidden">
                <a th:each="school : ${schoolCategory}"
                   th:href="@{'/school/' + ${school.englishName} + '/board/' + ${school.firstBoardId}}"
                   th:text="${school.koreanName}"
                   class="block text-gray-600 hover:text-primary"></a>
            </div>

            <a href="/agency/list" class="block pl-4 pr-4 py-2 text-gray-700 hover:bg-gray-100">유학원</a>
            <a th:if="${loginMember != null}" href="/survey/list"
               class="block pl-4 pr-4 py-2 text-gray-700 hover:bg-gray-100">설문조사</a>
        </div>
    </div>

    <script src="/js/homepage/nav-user.js" defer></script>
    <script src="/js/homepage/login.js" defer></script>
    <script src="/js/homepage/url.js" defer></script>
</nav>
